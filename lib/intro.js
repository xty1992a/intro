!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("Intro",[],e):"object"==typeof exports?exports.Intro=e():t.Intro=e()}(window,function(){return function(t){var e={};function n(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(o,r,function(e){return t[e]}.bind(null,r));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/",n(n.s=1)}([function(t,e,n){},function(t,e,n){"use strict";n.r(e);var o=function(){},r={},i=[],s=[];function a(t,e){var n,a,l,u,c=s;for(u=arguments.length;u-- >2;)i.push(arguments[u]);for(e&&null!=e.children&&(i.length||i.push(e.children),delete e.children);i.length;)if((a=i.pop())&&void 0!==a.pop)for(u=a.length;u--;)i.push(a[u]);else"boolean"==typeof a&&(a=null),(l="function"!=typeof t)&&(null==a?a="":"number"==typeof a?a=String(a):"string"!=typeof a&&(l=!1)),l&&n?c[c.length-1]+=a:c===s?c=[a]:c.push(a),n=l;var p=new o;return p.nodeName=t,p.children=c,p.attributes=null==e?void 0:e,p.key=null==e?void 0:e.key,void 0!==r.vnode&&r.vnode(p),p}function l(t,e){for(var n in e)t[n]=e[n];return t}function u(t,e){null!=t&&("function"==typeof t?t(e):t.current=e)}var c="function"==typeof Promise?Promise.resolve().then.bind(Promise.resolve()):setTimeout;var p=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,f=[];function d(t){!t._dirty&&(t._dirty=!0)&&1==f.push(t)&&(r.debounceRendering||c)(h)}function h(){for(var t;t=f.pop();)t._dirty&&E(t)}function v(t,e){return t.normalizedNodeName===e||t.nodeName.toLowerCase()===e.toLowerCase()}function m(t){var e=l({},t.attributes);e.children=t.children;var n=t.nodeName.defaultProps;if(void 0!==n)for(var o in n)void 0===e[o]&&(e[o]=n[o]);return e}function y(t){var e=t.parentNode;e&&e.removeChild(t)}function b(t,e,n,o,r){if("className"===e&&(e="class"),"key"===e);else if("ref"===e)u(n,null),u(o,t);else if("class"!==e||r)if("style"===e){if(o&&"string"!=typeof o&&"string"!=typeof n||(t.style.cssText=o||""),o&&"object"==typeof o){if("string"!=typeof n)for(var i in n)i in o||(t.style[i]="");for(var i in o)t.style[i]="number"==typeof o[i]&&!1===p.test(i)?o[i]+"px":o[i]}}else if("dangerouslySetInnerHTML"===e)o&&(t.innerHTML=o.__html||"");else if("o"==e[0]&&"n"==e[1]){var s=e!==(e=e.replace(/Capture$/,""));e=e.toLowerCase().substring(2),o?n||t.addEventListener(e,_,s):t.removeEventListener(e,_,s),(t._listeners||(t._listeners={}))[e]=o}else if("list"!==e&&"type"!==e&&!r&&e in t){try{t[e]=null==o?"":o}catch(t){}null!=o&&!1!==o||"spellcheck"==e||t.removeAttribute(e)}else{var a=r&&e!==(e=e.replace(/^xlink:?/,""));null==o||!1===o?a?t.removeAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase()):t.removeAttribute(e):"function"!=typeof o&&(a?t.setAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase(),o):t.setAttribute(e,o))}else t.className=o||""}function _(t){return this._listeners[t.type](r.event&&r.event(t)||t)}var g=[],x=0,w=!1,C=!1;function k(){for(var t;t=g.shift();)r.afterMount&&r.afterMount(t),t.componentDidMount&&t.componentDidMount()}function S(t,e,n,o,r,i){x++||(w=null!=r&&void 0!==r.ownerSVGElement,C=null!=t&&!("__preactattr_"in t));var s=N(t,e,n,o,i);return r&&s.parentNode!==r&&r.appendChild(s),--x||(C=!1,i||k()),s}function N(t,e,n,o,r){var i=t,s=w;if(null!=e&&"boolean"!=typeof e||(e=""),"string"==typeof e||"number"==typeof e)return t&&void 0!==t.splitText&&t.parentNode&&(!t._component||r)?t.nodeValue!=e&&(t.nodeValue=e):(i=document.createTextNode(e),t&&(t.parentNode&&t.parentNode.replaceChild(i,t),P(t,!0))),i.__preactattr_=!0,i;var a,l,u=e.nodeName;if("function"==typeof u)return function(t,e,n,o){var r=t&&t._component,i=r,s=t,a=r&&t._componentConstructor===e.nodeName,l=a,u=m(e);for(;r&&!l&&(r=r._parentComponent);)l=r.constructor===e.nodeName;r&&l&&(!o||r._component)?(B(r,u,3,n,o),t=r.base):(i&&!a&&(U(i),t=s=null),r=M(e.nodeName,u,n),t&&!r.nextBase&&(r.nextBase=t,s=null),B(r,u,1,n,o),t=r.base,s&&t!==s&&(s._component=null,P(s,!1)));return t}(t,e,n,o);if(w="svg"===u||"foreignObject"!==u&&w,u=String(u),(!t||!v(t,u))&&(a=u,(l=w?document.createElementNS("http://www.w3.org/2000/svg",a):document.createElement(a)).normalizedNodeName=a,i=l,t)){for(;t.firstChild;)i.appendChild(t.firstChild);t.parentNode&&t.parentNode.replaceChild(i,t),P(t,!0)}var c=i.firstChild,p=i.__preactattr_,f=e.children;if(null==p){p=i.__preactattr_={};for(var d=i.attributes,h=d.length;h--;)p[d[h].name]=d[h].value}return!C&&f&&1===f.length&&"string"==typeof f[0]&&null!=c&&void 0!==c.splitText&&null==c.nextSibling?c.nodeValue!=f[0]&&(c.nodeValue=f[0]):(f&&f.length||null!=c)&&function(t,e,n,o,r){var i,s,a,l,u,c=t.childNodes,p=[],f={},d=0,h=0,m=c.length,b=0,_=e?e.length:0;if(0!==m)for(var g=0;g<m;g++){var x=c[g],w=x.__preactattr_,C=_&&w?x._component?x._component.__key:w.key:null;null!=C?(d++,f[C]=x):(w||(void 0!==x.splitText?!r||x.nodeValue.trim():r))&&(p[b++]=x)}if(0!==_)for(var g=0;g<_;g++){l=e[g],u=null;var C=l.key;if(null!=C)d&&void 0!==f[C]&&(u=f[C],f[C]=void 0,d--);else if(h<b)for(i=h;i<b;i++)if(void 0!==p[i]&&(k=s=p[i],O=r,"string"==typeof(S=l)||"number"==typeof S?void 0!==k.splitText:"string"==typeof S.nodeName?!k._componentConstructor&&v(k,S.nodeName):O||k._componentConstructor===S.nodeName)){u=s,p[i]=void 0,i===b-1&&b--,i===h&&h++;break}u=N(u,l,n,o),a=c[g],u&&u!==t&&u!==a&&(null==a?t.appendChild(u):u===a.nextSibling?y(a):t.insertBefore(u,a))}var k,S,O;if(d)for(var g in f)void 0!==f[g]&&P(f[g],!1);for(;h<=b;)void 0!==(u=p[b--])&&P(u,!1)}(i,f,n,o,C||null!=p.dangerouslySetInnerHTML),function(t,e,n){var o;for(o in n)e&&null!=e[o]||null==n[o]||b(t,o,n[o],n[o]=void 0,w);for(o in e)"children"===o||"innerHTML"===o||o in n&&e[o]===("value"===o||"checked"===o?t[o]:n[o])||b(t,o,n[o],n[o]=e[o],w)}(i,e.attributes,p),w=s,i}function P(t,e){var n=t._component;n?U(n):(null!=t.__preactattr_&&u(t.__preactattr_.ref,null),!1!==e&&null!=t.__preactattr_||y(t),O(t))}function O(t){for(t=t.lastChild;t;){var e=t.previousSibling;P(t,!0),t=e}}var j=[];function M(t,e,n){var o,r=j.length;for(t.prototype&&t.prototype.render?(o=new t(e,n),A.call(o,e,n)):((o=new A(e,n)).constructor=t,o.render=T);r--;)if(j[r].constructor===t)return o.nextBase=j[r].nextBase,j.splice(r,1),o;return o}function T(t,e,n){return this.constructor(t,n)}function B(t,e,n,o,i){t._disable||(t._disable=!0,t.__ref=e.ref,t.__key=e.key,delete e.ref,delete e.key,void 0===t.constructor.getDerivedStateFromProps&&(!t.base||i?t.componentWillMount&&t.componentWillMount():t.componentWillReceiveProps&&t.componentWillReceiveProps(e,o)),o&&o!==t.context&&(t.prevContext||(t.prevContext=t.context),t.context=o),t.prevProps||(t.prevProps=t.props),t.props=e,t._disable=!1,0!==n&&(1!==n&&!1===r.syncComponentUpdates&&t.base?d(t):E(t,1,i)),u(t.__ref,t))}function E(t,e,n,o){if(!t._disable){var i,s,a,u=t.props,c=t.state,p=t.context,f=t.prevProps||u,d=t.prevState||c,h=t.prevContext||p,v=t.base,y=t.nextBase,b=v||y,_=t._component,w=!1,C=h;if(t.constructor.getDerivedStateFromProps&&(c=l(l({},c),t.constructor.getDerivedStateFromProps(u,c)),t.state=c),v&&(t.props=f,t.state=d,t.context=h,2!==e&&t.shouldComponentUpdate&&!1===t.shouldComponentUpdate(u,c,p)?w=!0:t.componentWillUpdate&&t.componentWillUpdate(u,c,p),t.props=u,t.state=c,t.context=p),t.prevProps=t.prevState=t.prevContext=t.nextBase=null,t._dirty=!1,!w){i=t.render(u,c,p),t.getChildContext&&(p=l(l({},p),t.getChildContext())),v&&t.getSnapshotBeforeUpdate&&(C=t.getSnapshotBeforeUpdate(f,d));var N,O,j=i&&i.nodeName;if("function"==typeof j){var T=m(i);(s=_)&&s.constructor===j&&T.key==s.__key?B(s,T,1,p,!1):(N=s,t._component=s=M(j,T,p),s.nextBase=s.nextBase||y,s._parentComponent=t,B(s,T,0,p,!1),E(s,1,n,!0)),O=s.base}else a=b,(N=_)&&(a=t._component=null),(b||1===e)&&(a&&(a._component=null),O=S(a,i,p,n||!v,b&&b.parentNode,!0));if(b&&O!==b&&s!==_){var A=b.parentNode;A&&O!==A&&(A.replaceChild(O,b),N||(b._component=null,P(b,!1)))}if(N&&U(N),t.base=O,O&&!o){for(var W=t,$=t;$=$._parentComponent;)(W=$).base=O;O._component=W,O._componentConstructor=W.constructor}}for(!v||n?g.push(t):w||(t.componentDidUpdate&&t.componentDidUpdate(f,d,C),r.afterUpdate&&r.afterUpdate(t));t._renderCallbacks.length;)t._renderCallbacks.pop().call(t);x||o||k()}}function U(t){r.beforeUnmount&&r.beforeUnmount(t);var e=t.base;t._disable=!0,t.componentWillUnmount&&t.componentWillUnmount(),t.base=null;var n=t._component;n?U(n):e&&(null!=e.__preactattr_&&u(e.__preactattr_.ref,null),t.nextBase=e,y(e),j.push(t),O(e)),u(t.__ref,null)}function A(t,e){this._dirty=!0,this.context=e,this.props=t,this.state=this.state||{},this._renderCallbacks=[]}function W(t,e,n){return S(n,t,{},!1,e,!1)}l(A.prototype,{setState:function(t,e){this.prevState||(this.prevState=this.state),this.state=l(l({},this.state),"function"==typeof t?t(this.state,this.props):t),e&&this._renderCallbacks.push(e),d(this)},forceUpdate:function(t){t&&this._renderCallbacks.push(t),E(this,2)},render:function(){}});var $={h:a,createElement:a,cloneElement:function(t,e){return a(t.nodeName,l(l({},t.attributes),e),arguments.length>2?[].slice.call(arguments,2):t.children)},createRef:function(){return{}},Component:A,render:W,rerender:h,options:r},D=(n(0),function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}());function I(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}var L=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.state={style:"",text:"",textStyle:"",manStyle:"",textPosition:"bottom"},n.next=function(){if(!n.onWaiting){var t=n.props.steps[n.step+1];t?(n.onWaiting=!0,n.props.onBeforeNext(t,function(){n.onWaiting=!1,n.step++,n.onStep()},function(){n.onWaiting=!1,n.step+=2,n.onStep()})):n.exit()}},n.close=function(){var t=n.base;t&&(W(null,t.parentNode,t),t.remove())},n.exit=function(){n.close(),n.props.onDone&&n.props.onDone()},n.step=-1,n.next(),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,A),D(e,[{key:"modalProps",get:function(){if(!this.currentStep)return{};var t=this.currentStep,e=t.el,n=t.text;e instanceof Function&&(e=e());var o={};if(e instanceof Element)o=e.getBoundingClientRect();else if(Array.isArray(e)){var r=document.documentElement,i=r.clientWidth,s=r.clientHeight,a=i,l=0,u=s,c=0;e.forEach(function(t){var e=t.getBoundingClientRect();a=Math.min(a,e.left),u=Math.min(u,e.top),l=Math.max(l,e.right),c=Math.max(c,e.bottom)}),o={left:a,top:u,width:l-a,height:c-u}}var p=o,f=p.width,d=p.height,h=p.left,v=p.top;return{width:f,height:d,left:h,top:v,text:n,right:f+h,bottom:v+d}}},{key:"currentStep",get:function(){return this.props.steps.length&&this.props.steps[this.step]||null}}]),D(e,[{key:"onStep",value:function(){this.step>=this.props.steps.length||!this.currentStep?this.exit():(this.getTextPosition(),this.setStyle(),this.setTextStyle(),this.setState({text:this.currentStep.text}))}},{key:"setStyle",value:function(){var t=this.modalProps,e=t.width,n=t.height,o=t.left,r=t.top;this.setState({style:"\n\twidth: "+e+"px;\n\theight: "+n+"px;\n\tleft: "+o+"px;\n\ttop: "+r+"px;\n\t"})}},{key:"getTextPosition",value:function(){var t=document.documentElement,e=t.clientWidth,n=t.clientHeight,o=this.modalProps,r=o.right,i=o.bottom,s={left:o.left,top:o.top,right:e-r,bottom:n-i},a=Object.keys(s),l=Math.max.apply(Math,I(a.reduce(function(t,e){return[].concat(I(t),[s[e]])},[])));console.log("position ",a.find(function(t){return s[t]===l})," is largest"),this.setState({textPosition:a.find(function(t){return s[t]===l})})}},{key:"setTextStyle",value:function(){var t=this.state.textPosition,e=this.modalProps,n=e.width,o=e.height,r=e.left,i=e.top,s="";switch(t){case"bottom":i=i+o+70,r+=n/4;break;case"top":i-=150,r+=n/4;break;case"right":i+=o/2,r=r+n+70;break;case"left":i+=o/2,r-=80,s="translate3d(-100%,-.5em,0)"}this.setState({textPosition:t,textStyle:"\n\t  \ttransform: "+s+";\n\t  \ttop: "+i+"px;\n\t  \tleft: "+r+"px;\n\t  \tcolor: #fff;\n\t  "})}},{key:"render",value:function(t,e,n){return $.h("div",{class:"intro-container"},$.h("div",{className:"intro-modal arrow__"+this.state.textPosition,style:this.state.style,onClick:this.props.onClickModal}),$.h("div",{class:"text",style:this.state.textStyle},$.h("p",null,this.state.text),$.h("button",{onClick:this.exit},"跳过"),$.h("button",{onClick:this.next,class:"next"},"继续")))}}]),e}(),R=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},H=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();function V(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function F(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var K={getItem:function(t){try{return JSON.parse(localStorage.getItem(t))}catch(t){return null}},setItem:function(t,e){try{return localStorage.setItem(t,JSON.stringify(e)),!0}catch(t){return!1}}},z=function(){function t(){F(this,t),this._task={}}return H(t,[{key:"on",value:function(t,e){this._task[t]=e}},{key:"off",value:function(t){this._task[t]=null}},{key:"fire",value:function(t,e){this._task[t]&&this._task[t](e)}}]),t}(),J={steps:[],playCount:1,storageKey:"intro_play_count"},G=function(t){function e(t){F(this,e);var n=V(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return q.call(n),n.$options=R({},J,t),(K.getItem(n.$options.storageKey)||0)>=n.$options.playCount?(console.log("intro play count is over the limit !"),V(n)):(setTimeout(function(){n.onBeforeNext(n.$options.steps[0],function(){console.log("first show",n.$options.steps[0].el()),n.show()},function(){n.$options.steps.splice(0,1),n.show()})},20),n)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,z),H(e,[{key:"show",value:function(){var t=this.$el=document.createElement("div");document.body.appendChild(t),this.hide(),W($.h(L,R({},this.$options,{onBeforeNext:this.onBeforeNext,onDone:this.onDone,onClickModal:this.onClickModal,onAbort:this.onAbort})),document.body,t)}}]),e}(),q=function(){var t=this;this.onBeforeNext=function(e,n,o){t._task["before-next"]?t.fire("before-next",{step:e,next:n,skip:o}):n()},this.onDone=function(){var e=K.getItem(t.$options.storageKey)||0;K.setItem(t.$options.storageKey,e+1),t.fire("done")},this.onAbort=function(){t.fire("abort")},this.hide=function(){W(null,t.$el.parentNode,t.$el)}};e.default=G}]).default});